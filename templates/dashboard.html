<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Golf Club Sensor Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .status {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .status.connected {
            background: rgba(76, 175, 80, 0.3);
        }
        
        .status.disconnected {
            background: rgba(244, 67, 54, 0.3);
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .card h3 {
            margin-top: 0;
            color: #ffd700;
        }
        
        .metric {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            padding: 8px;
            background: rgba(255,255,255,0.05);
            border-radius: 5px;
        }
        
        .metric-label {
            font-weight: bold;
        }
        
        .metric-value {
            color: #4CAF50;
            font-weight: bold;
        }
        
        .swing-indicator {
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            transition: all 0.3s ease;
        }
        
        .swing-indicator.active {
            background: rgba(255, 0, 0, 0.3);
            animation: pulse 0.5s infinite;
        }
        
        .swing-indicator.inactive {
            background: rgba(0, 255, 0, 0.3);
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 20px;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .data-table th,
        .data-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }
        
        .data-table th {
            background: rgba(255,255,255,0.1);
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèåÔ∏è Golf Club Sensor Dashboard</h1>
        </div>
        
        <div id="status" class="status disconnected">
            <strong>Status:</strong> <span id="status-text">Disconnected</span>
        </div>
        
        <div class="grid">
            <div class="card">
                <h3>üìä Accelerometer Data</h3>
                <div class="metric">
                    <span class="metric-label">X-axis:</span>
                    <span class="metric-value" id="accel-x">0.00 g</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Y-axis:</span>
                    <span class="metric-value" id="accel-y">0.00 g</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Z-axis:</span>
                    <span class="metric-value" id="accel-z">0.00 g</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Magnitude:</span>
                    <span class="metric-value" id="accel-mag">0.00 g</span>
                </div>
            </div>
            
            <div class="card">
                <h3>üîÑ Gyroscope Data</h3>
                <div class="metric">
                    <span class="metric-label">X-axis:</span>
                    <span class="metric-value" id="gyro-x">0.00 ¬∞/s</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Y-axis:</span>
                    <span class="metric-value" id="gyro-y">0.00 ¬∞/s</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Z-axis:</span>
                    <span class="metric-value" id="gyro-z">0.00 ¬∞/s</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Magnitude:</span>
                    <span class="metric-value" id="gyro-mag">0.00 ¬∞/s</span>
                </div>
            </div>
            
            <div class="card">
                <h3>üå°Ô∏è Environmental</h3>
                <div class="metric">
                    <span class="metric-label">Temperature:</span>
                    <span class="metric-value" id="temperature">0.00 ¬∞C</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Last Update:</span>
                    <span class="metric-value" id="last-update">Never</span>
                </div>
            </div>
        </div>
        
        <div class="swing-indicator inactive" id="swing-indicator">
            <h3>üéØ Swing Detection</h3>
            <p id="swing-status">No swing detected</p>
        </div>
        
        <div class="card">
            <h3>üìà Real-time Data Chart</h3>
            <div class="chart-container">
                <canvas id="dataChart"></canvas>
            </div>
        </div>
        
        <div class="card">
            <h3>üìã Raw Data</h3>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Timestamp</th>
                        <th>Accel X</th>
                        <th>Accel Y</th>
                        <th>Accel Z</th>
                        <th>Gyro X</th>
                        <th>Gyro Y</th>
                        <th>Gyro Z</th>
                    </tr>
                </thead>
                <tbody id="data-table-body">
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Initialize Socket.IO connection
        const socket = io();
        
        // Chart setup
        const ctx = document.getElementById('dataChart').getContext('2d');
        const chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [
                    {
                        label: 'Accel Magnitude',
                        data: [],
                        borderColor: 'rgb(75, 192, 192)',
                        tension: 0.1
                    },
                    {
                        label: 'Gyro Magnitude',
                        data: [],
                        borderColor: 'rgb(255, 99, 132)',
                        tension: 0.1
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
        
        // Data storage
        let dataHistory = [];
        const maxHistory = 50;
        
        // Socket event handlers
        socket.on('connect', function() {
            updateStatus('Connected', true);
        });
        
        socket.on('disconnect', function() {
            updateStatus('Disconnected', false);
        });
        
        socket.on('sensor_data', function(data) {
            updateSensorData(data);
        });
        
        socket.on('processed_data', function(data) {
            updateProcessedData(data);
        });
        
        function updateStatus(message, connected) {
            const statusElement = document.getElementById('status');
            const statusText = document.getElementById('status-text');
            
            statusText.textContent = message;
            statusElement.className = connected ? 'status connected' : 'status disconnected';
        }
        
        function updateSensorData(data) {
            // Update accelerometer data
            document.getElementById('accel-x').textContent = data.accelerometer.x.toFixed(2) + ' g';
            document.getElementById('accel-y').textContent = data.accelerometer.y.toFixed(2) + ' g';
            document.getElementById('accel-z').textContent = data.accelerometer.z.toFixed(2) + ' g';
            
            // Update gyroscope data
            document.getElementById('gyro-x').textContent = data.gyroscope.x.toFixed(2) + ' ¬∞/s';
            document.getElementById('gyro-y').textContent = data.gyroscope.y.toFixed(2) + ' ¬∞/s';
            document.getElementById('gyro-z').textContent = data.gyroscope.z.toFixed(2) + ' ¬∞/s';
            
            // Update temperature
            document.getElementById('temperature').textContent = data.temperature.toFixed(2) + ' ¬∞C';
            
            // Update timestamp
            const now = new Date();
            document.getElementById('last-update').textContent = now.toLocaleTimeString();
            
            // Add to data history
            dataHistory.push({
                timestamp: now,
                accelX: data.accelerometer.x,
                accelY: data.accelerometer.y,
                accelZ: data.accelerometer.z,
                gyroX: data.gyroscope.x,
                gyroY: data.gyroscope.y,
                gyroZ: data.gyroscope.z
            });
            
            if (dataHistory.length > maxHistory) {
                dataHistory.shift();
            }
            
            updateDataTable();
        }
        
        function updateProcessedData(data) {
            const metrics = data.metrics;
            
            // Update magnitude displays
            document.getElementById('accel-mag').textContent = metrics.accel_magnitude.toFixed(2) + ' g';
            document.getElementById('gyro-mag').textContent = metrics.gyro_magnitude.toFixed(2) + ' ¬∞/s';
            
            // Update swing detection
            const swingIndicator = document.getElementById('swing-indicator');
            const swingStatus = document.getElementById('swing-status');
            
            if (metrics.swing_detected) {
                swingIndicator.className = 'swing-indicator active';
                swingStatus.textContent = 'SWING DETECTED! üèåÔ∏è';
            } else {
                swingIndicator.className = 'swing-indicator inactive';
                swingStatus.textContent = 'No swing detected';
            }
            
            // Update chart
            updateChart(metrics.accel_magnitude, metrics.gyro_magnitude);
        }
        
        function updateChart(accelMag, gyroMag) {
            const now = new Date();
            const timeLabel = now.toLocaleTimeString();
            
            chart.data.labels.push(timeLabel);
            chart.data.datasets[0].data.push(accelMag);
            chart.data.datasets[1].data.push(gyroMag);
            
            // Keep only last 20 data points
            if (chart.data.labels.length > 20) {
                chart.data.labels.shift();
                chart.data.datasets[0].data.shift();
                chart.data.datasets[1].data.shift();
            }
            
            chart.update();
        }
        
        function updateDataTable() {
            const tbody = document.getElementById('data-table-body');
            tbody.innerHTML = '';
            
            // Show last 10 entries
            const recentData = dataHistory.slice(-10).reverse();
            
            recentData.forEach(data => {
                const row = tbody.insertRow();
                row.insertCell(0).textContent = data.timestamp.toLocaleTimeString();
                row.insertCell(1).textContent = data.accelX.toFixed(2);
                row.insertCell(2).textContent = data.accelY.toFixed(2);
                row.insertCell(3).textContent = data.accelZ.toFixed(2);
                row.insertCell(4).textContent = data.gyroX.toFixed(2);
                row.insertCell(5).textContent = data.gyroY.toFixed(2);
                row.insertCell(6).textContent = data.gyroZ.toFixed(2);
            });
        }
    </script>
</body>
</html>
